(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71594,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},86535,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={assign:function(){return c},searchParamsToUrlQuery:function(){return s},urlQueryToSearchParams:function(){return i}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});function s(e){let t={};for(let[r,a]of e.entries()){let e=t[r];void 0===e?t[r]=a:Array.isArray(e)?e.push(a):t[r]=[e,a]}return t}function l(e){return"string"==typeof e?e:("number"!=typeof e||isNaN(e))&&"boolean"!=typeof e?"":String(e)}function i(e){let t=new URLSearchParams;for(let[r,a]of Object.entries(e))if(Array.isArray(a))for(let e of a)t.append(r,l(e));else t.set(r,l(a));return t}function c(e,...t){for(let r of t){for(let t of r.keys())e.delete(t);for(let[t,a]of r.entries())e.append(t,a)}return e}},29434,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={formatUrl:function(){return i},formatWithValidation:function(){return o},urlObjectKeys:function(){return c}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let s=e.r(60292)._(e.r(86535)),l=/https?|ftp|gopher|file/;function i(e){let{auth:t,hostname:r}=e,a=e.protocol||"",n=e.pathname||"",i=e.hash||"",c=e.query||"",o=!1;t=t?encodeURIComponent(t).replace(/%3A/i,":")+"@":"",e.host?o=t+e.host:r&&(o=t+(~r.indexOf(":")?`[${r}]`:r),e.port&&(o+=":"+e.port)),c&&"object"==typeof c&&(c=String(s.urlQueryToSearchParams(c)));let d=e.search||c&&`?${c}`||"";return a&&!a.endsWith(":")&&(a+=":"),e.slashes||(!a||l.test(a))&&!1!==o?(o="//"+(o||""),n&&"/"!==n[0]&&(n="/"+n)):o||(o=""),i&&"#"!==i[0]&&(i="#"+i),d&&"?"!==d[0]&&(d="?"+d),n=n.replace(/[?#]/g,encodeURIComponent),d=d.replace("#","%23"),`${a}${o}${n}${d}${i}`}let c=["auth","hash","host","hostname","href","path","pathname","port","protocol","query","search","slashes"];function o(e){return i(e)}},68005,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useMergedRef",{enumerable:!0,get:function(){return n}});let a=e.r(62415);function n(e,t){let r=(0,a.useRef)(null),n=(0,a.useRef)(null);return(0,a.useCallback)(a=>{if(null===a){let e=r.current;e&&(r.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(r.current=s(e,a)),t&&(n.current=s(t,a))},[e,t])}function s(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},58467,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={DecodeError:function(){return g},MiddlewareNotFoundError:function(){return v},MissingStaticPage:function(){return y},NormalizeError:function(){return b},PageNotFoundError:function(){return j},SP:function(){return p},ST:function(){return f},WEB_VITALS:function(){return s},execOnce:function(){return l},getDisplayName:function(){return u},getLocationOrigin:function(){return o},getURL:function(){return d},isAbsoluteUrl:function(){return c},isResSent:function(){return h},loadGetInitialProps:function(){return m},normalizeRepeatedSlashes:function(){return x},stringifyError:function(){return N}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let s=["CLS","FCP","FID","INP","LCP","TTFB"];function l(e){let t,r=!1;return(...a)=>(r||(r=!0,t=e(...a)),t)}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,c=e=>i.test(e);function o(){let{protocol:e,hostname:t,port:r}=window.location;return`${e}//${t}${r?":"+r:""}`}function d(){let{href:e}=window.location,t=o();return e.substring(t.length)}function u(e){return"string"==typeof e?e:e.displayName||e.name||"Unknown"}function h(e){return e.finished||e.headersSent}function x(e){let t=e.split("?");return t[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(t[1]?`?${t.slice(1).join("?")}`:"")}async function m(e,t){let r=t.res||t.ctx&&t.ctx.res;if(!e.getInitialProps)return t.ctx&&t.Component?{pageProps:await m(t.Component,t.ctx)}:{};let a=await e.getInitialProps(t);if(r&&h(r))return a;if(!a)throw Object.defineProperty(Error(`"${u(e)}.getInitialProps()" should resolve to an object. But found "${a}" instead.`),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return a}let p="undefined"!=typeof performance,f=p&&["mark","measure","getEntriesByName"].every(e=>"function"==typeof performance[e]);class g extends Error{}class b extends Error{}class j extends Error{constructor(e){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message=`Cannot find module for page: ${e}`}}class y extends Error{constructor(e,t){super(),this.message=`Failed to load static file for page: ${e} ${t}`}}class v extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}}function N(e){return JSON.stringify({message:e.message,stack:e.stack})}},86568,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"isLocalURL",{enumerable:!0,get:function(){return s}});let a=e.r(58467),n=e.r(86960);function s(e){if(!(0,a.isAbsoluteUrl)(e))return!0;try{let t=(0,a.getLocationOrigin)(),r=new URL(e,t);return r.origin===t&&(0,n.hasBasePath)(r.pathname)}catch(e){return!1}}},18062,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"errorOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},30065,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={default:function(){return g},useLinkStatus:function(){return j}};for(var n in a)Object.defineProperty(r,n,{enumerable:!0,get:a[n]});let s=e.r(60292),l=e.r(94606),i=s._(e.r(62415)),c=e.r(29434),o=e.r(96740),d=e.r(68005),u=e.r(58467),h=e.r(71935);e.r(71594);let x=e.r(32317),m=e.r(86568),p=e.r(11888);function f(e){return"string"==typeof e?e:(0,c.formatUrl)(e)}function g(t){var r;let a,n,s,[c,g]=(0,i.useOptimistic)(x.IDLE_LINK_STATUS),j=(0,i.useRef)(null),{href:y,as:v,children:N,prefetch:C=null,passHref:T,replace:w,shallow:k,scroll:_,onClick:P,onMouseEnter:S,onTouchStart:E,legacyBehavior:L=!1,onNavigate:O,ref:I,unstable_dynamicOnHover:H,...R}=t;a=N,L&&("string"==typeof a||"number"==typeof a)&&(a=(0,l.jsx)("a",{children:a}));let B=i.default.useContext(o.AppRouterContext),D=!1!==C,M=!1!==C?null===(r=C)||"auto"===r?p.FetchStrategy.PPR:p.FetchStrategy.Full:p.FetchStrategy.PPR,{href:U,as:$}=i.default.useMemo(()=>{let e=f(y);return{href:e,as:v?f(v):e}},[y,v]);if(L){if(a?.$$typeof===Symbol.for("react.lazy"))throw Object.defineProperty(Error("`<Link legacyBehavior>` received a direct child that is either a Server Component, or JSX that was loaded with React.lazy(). This is not supported. Either remove legacyBehavior, or make the direct child a Client Component that renders the Link's `<a>` tag."),"__NEXT_ERROR_CODE",{value:"E863",enumerable:!1,configurable:!0});n=i.default.Children.only(a)}let A=L?n&&"object"==typeof n&&n.ref:I,F=i.default.useCallback(e=>(null!==B&&(j.current=(0,x.mountLinkInstance)(e,U,B,M,D,g)),()=>{j.current&&((0,x.unmountLinkForCurrentNavigation)(j.current),j.current=null),(0,x.unmountPrefetchableInstance)(e)}),[D,U,B,M,g]),q={ref:(0,d.useMergedRef)(F,A),onClick(t){L||"function"!=typeof P||P(t),L&&n.props&&"function"==typeof n.props.onClick&&n.props.onClick(t),!B||t.defaultPrevented||function(t,r,a,n,s,l,c){if("undefined"!=typeof window){let o,{nodeName:d}=t.currentTarget;if("A"===d.toUpperCase()&&((o=t.currentTarget.getAttribute("target"))&&"_self"!==o||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which)||t.currentTarget.hasAttribute("download"))return;if(!(0,m.isLocalURL)(r)){s&&(t.preventDefault(),location.replace(r));return}if(t.preventDefault(),c){let e=!1;if(c({preventDefault:()=>{e=!0}}),e)return}let{dispatchNavigateAction:u}=e.r(32791);i.default.startTransition(()=>{u(a||r,s?"replace":"push",l??!0,n.current)})}}(t,U,$,j,w,_,O)},onMouseEnter(e){L||"function"!=typeof S||S(e),L&&n.props&&"function"==typeof n.props.onMouseEnter&&n.props.onMouseEnter(e),B&&D&&(0,x.onNavigationIntent)(e.currentTarget,!0===H)},onTouchStart:function(e){L||"function"!=typeof E||E(e),L&&n.props&&"function"==typeof n.props.onTouchStart&&n.props.onTouchStart(e),B&&D&&(0,x.onNavigationIntent)(e.currentTarget,!0===H)}};return(0,u.isAbsoluteUrl)($)?q.href=$:L&&!T&&("a"!==n.type||"href"in n.props)||(q.href=(0,h.addBasePath)($)),s=L?i.default.cloneElement(n,q):(0,l.jsx)("a",{...R,...q,children:a}),(0,l.jsx)(b.Provider,{value:c,children:s})}e.r(18062);let b=(0,i.createContext)(x.IDLE_LINK_STATUS),j=()=>(0,i.useContext)(b);("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),t.exports=r.default)},97873,e=>{"use strict";var t=e.i(94606),r=e.i(23952);function a({className:e,type:a,...n}){return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}e.s(["Input",()=>a])},5900,e=>{"use strict";var t=e.i(62415);let r=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,t.forwardRef)(({color:e="currentColor",size:n=24,strokeWidth:s=2,absoluteStrokeWidth:l,className:i="",children:c,iconNode:o,...d},u)=>(0,t.createElement)("svg",{ref:u,...a,width:n,height:n,stroke:e,strokeWidth:l?24*Number(s)/Number(n):s,className:r("lucide",i),...d},[...o.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(c)?c:[c]])),s=(e,a)=>{let s=(0,t.forwardRef)(({className:s,...l},i)=>(0,t.createElement)(n,{ref:i,iconNode:a,className:r(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,s),...l}));return s.displayName=`${e}`,s};e.s(["default",()=>s],5900)},50370,e=>{"use strict";let t=(0,e.i(5900).default)("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],50370)},16934,e=>{"use strict";let t=(0,e.i(5900).default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);e.s(["TrendingDown",()=>t],16934)},34378,e=>{"use strict";let t=(0,e.i(5900).default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);e.s(["Download",()=>t],34378)},81218,e=>{"use strict";let t=(0,e.i(5900).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],81218)},9791,e=>{"use strict";let t=(0,e.i(5900).default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);e.s(["Trash2",()=>t],9791)},76459,30750,e=>{"use strict";var t=e.i(94606),r=e.i(23952);function a({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,r.cn)("w-full caption-bottom text-sm",e),...a})})}function n({className:e,...a}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,r.cn)("[&_tr]:border-b",e),...a})}function s({className:e,...a}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,r.cn)("[&_tr:last-child]:border-0",e),...a})}function l({className:e,...a}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,r.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...a})}function i({className:e,...a}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,r.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}function c({className:e,...a}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,r.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...a})}e.s(["Table",()=>a,"TableBody",()=>s,"TableCell",()=>c,"TableHead",()=>i,"TableHeader",()=>n,"TableRow",()=>l],76459);let o=(0,e.i(5900).default)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>o],30750)},79257,e=>{"use strict";var t=e.i(94606),r=e.i(62415),a=e.i(52572),n=e.i(11983),s=e.i(42268),l=e.i(63918),i=e.i(97873),c=e.i(51087),o=e.i(76459),d=e.i(40215),u=e.i(93810),h=e.i(81218),x=e.i(34378),m=e.i(9791),p=e.i(30750),f=e.i(50370),g=e.i(49510),b=e.i(16934),j=e.i(66715);let y=(0,e.i(5900).default)("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var v=e.i(30065);function N(){let{user:e}=(0,a.useAuth)(),N=(0,n.useRouter)(),[C,T]=(0,r.useState)([]),[w,k]=(0,r.useState)(!0),[_,P]=(0,r.useState)(!1),[S,E]=(0,r.useState)(null),[L,O]=(0,r.useState)("list"),[I,H]=(0,r.useState)({batchDate:new Date().toISOString().split("T")[0],supplierName:"",notes:"",items:[]}),[R,B]=(0,r.useState)({productName:"",category:"",color:"",variety:"",quantity:0,purchasePrice:0,sellingPrice:0,stemLength:"",packagingType:"",plantationCountry:"Китай",notes:""}),[D,M]=(0,r.useState)(null),[U,$]=(0,r.useState)([]);(0,r.useEffect)(()=>{e&&["admin","worker"].includes(e.role)?A():N.push("/auth/login")},[e]);let A=async()=>{try{k(!0);let t=await s.api.getInventoryBatches({userId:e?.id});t.success&&T(t.batches)}catch(e){console.error("Error loading batches:",e)}finally{k(!1)}},F=async e=>{try{let t=await s.api.getInventoryBatch(e);t.success&&(E(t),O("details"))}catch(e){console.error("Error loading batch details:",e)}},q=async()=>{try{let[e,t]=await Promise.all([s.api.getInventoryByCategory({}),s.api.getInventoryPriceComparison({})]);e.success&&M(e.data),t.success&&$(t.data),O("analytics")}catch(e){console.error("Error loading analytics:",e)}},z=async()=>{if(0===I.items.length)return void alert("Добавьте хотя бы один товар в партию");try{let t=await s.api.createInventoryBatch({userId:e.id,batchDate:I.batchDate,supplierName:I.supplierName,notes:I.notes,items:I.items});t.success&&(alert(`Партия создана! Всего ${t.totalItems} единиц на сумму ${t.totalCost} тг`),P(!1),H({batchDate:new Date().toISOString().split("T")[0],supplierName:"",notes:"",items:[]}),A())}catch(e){console.error("Error creating batch:",e),alert("Ошибка при создании партии")}},K=async e=>{try{let t=await s.api.exportInventoryCSV({batchId:e});if(console.log("Export response type:",typeof t),console.log("Export response:",t?.substring?t.substring(0,100):t),t){if("object"==typeof t){console.error("Export returned object instead of CSV text:",t),alert(t.message||"Нет данных для экспорта");return}let r=new Blob([t],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(r),a.download=`inventory_${e||"all"}_${new Date().toISOString().split("T")[0]}.csv`,a.click()}}catch(e){console.error("Export error:",e),alert("Ошибка при экспорте")}},V=async(t,r)=>{try{(await s.api.updateInventoryBatch(t,{userId:e.id,status:r})).success&&(A(),S?.batch?.id===t&&F(t))}catch(e){console.error("Error updating status:",e)}},W=e=>(0,t.jsx)(u.Badge,{className:{draft:"bg-gray-100 text-gray-800",received:"bg-green-100 text-green-800",processed:"bg-blue-100 text-blue-800"}[e],children:{draft:"Черновик",received:"Получено",processed:"Обработано"}[e]});return w?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin w-12 h-12 border-4 border-[#568a56] border-t-transparent rounded-full"})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(v.default,{href:"/admin",className:"text-gray-600 hover:text-gray-900",children:(0,t.jsx)(j.ChevronLeft,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Управление поставками"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Еженедельный учет товаров"})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(l.Button,{variant:"outline",onClick:()=>O("list"),children:[(0,t.jsx)(f.Package,{className:"h-4 w-4 mr-2"}),"Партии"]}),(0,t.jsxs)(l.Button,{variant:"outline",onClick:q,children:[(0,t.jsx)(g.TrendingUp,{className:"h-4 w-4 mr-2"}),"Аналитика"]}),(0,t.jsxs)(l.Button,{onClick:()=>K(),children:[(0,t.jsx)(x.Download,{className:"h-4 w-4 mr-2"}),"Экспорт всего"]}),(0,t.jsxs)(d.Dialog,{open:_,onOpenChange:P,children:[(0,t.jsx)(d.DialogTrigger,{asChild:!0,children:(0,t.jsxs)(l.Button,{className:"bg-[#568a56] hover:bg-[#467046]",children:[(0,t.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Новая партия"]})}),(0,t.jsxs)(d.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,t.jsx)(d.DialogHeader,{children:(0,t.jsx)(d.DialogTitle,{children:"Создание партии поставки"})}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Дата поставки"}),(0,t.jsx)(i.Input,{type:"date",value:I.batchDate,onChange:e=>H(t=>({...t,batchDate:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Поставщик"}),(0,t.jsx)(i.Input,{placeholder:"Название поставщика",value:I.supplierName,onChange:e=>H(t=>({...t,supplierName:e.target.value}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Примечания"}),(0,t.jsx)(i.Input,{placeholder:"Примечания к партии",value:I.notes,onChange:e=>H(t=>({...t,notes:e.target.value}))})]})]}),(0,t.jsxs)(c.Card,{className:"mb-4",children:[(0,t.jsx)(c.CardHeader,{className:"py-3",children:(0,t.jsx)(c.CardTitle,{className:"text-sm",children:"Добавить товар"})}),(0,t.jsxs)(c.CardContent,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-3 mb-3",children:[(0,t.jsx)(i.Input,{placeholder:"Название *",value:R.productName,onChange:e=>B(t=>({...t,productName:e.target.value}))}),(0,t.jsx)(i.Input,{placeholder:"Категория",value:R.category,onChange:e=>B(t=>({...t,category:e.target.value}))}),(0,t.jsx)(i.Input,{placeholder:"Цвет",value:R.color,onChange:e=>B(t=>({...t,color:e.target.value}))}),(0,t.jsx)(i.Input,{placeholder:"Сорт",value:R.variety,onChange:e=>B(t=>({...t,variety:e.target.value}))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-5 gap-3 mb-3",children:[(0,t.jsx)(i.Input,{type:"number",placeholder:"Кол-во *",value:R.quantity||"",onChange:e=>B(t=>({...t,quantity:Number(e.target.value)}))}),(0,t.jsx)(i.Input,{type:"number",step:"0.01",placeholder:"Закуп. цена *",value:R.purchasePrice||"",onChange:e=>B(t=>({...t,purchasePrice:Number(e.target.value)}))}),(0,t.jsx)(i.Input,{type:"number",step:"0.01",placeholder:"Продаж. цена",value:R.sellingPrice||"",onChange:e=>B(t=>({...t,sellingPrice:Number(e.target.value)}))}),(0,t.jsx)(i.Input,{placeholder:"Длина стебля",value:R.stemLength,onChange:e=>B(t=>({...t,stemLength:e.target.value}))}),(0,t.jsx)(i.Input,{placeholder:"Страна",value:R.plantationCountry,onChange:e=>B(t=>({...t,plantationCountry:e.target.value}))})]}),(0,t.jsxs)(l.Button,{onClick:()=>{!R.productName||R.quantity<=0||R.purchasePrice<=0?alert("Заполните обязательные поля: название, количество и закупочную цену"):(H(e=>({...e,items:[...e.items,{...R}]})),B({productName:"",category:"",color:"",variety:"",quantity:0,purchasePrice:0,sellingPrice:0,stemLength:"",packagingType:"",plantationCountry:"Китай",notes:""}))},className:"w-full",children:[(0,t.jsx)(h.Plus,{className:"h-4 w-4 mr-2"}),"Добавить в партию"]})]})]}),I.items.length>0&&(0,t.jsxs)("div",{className:"border rounded-lg overflow-hidden mb-4",children:[(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{children:(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableHead,{children:"Название"}),(0,t.jsx)(o.TableHead,{children:"Категория"}),(0,t.jsx)(o.TableHead,{children:"Кол-во"}),(0,t.jsx)(o.TableHead,{children:"Закуп. цена"}),(0,t.jsx)(o.TableHead,{children:"Сумма"}),(0,t.jsx)(o.TableHead,{})]})}),(0,t.jsx)(o.TableBody,{children:I.items.map((e,r)=>(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableCell,{className:"font-medium",children:e.productName}),(0,t.jsx)(o.TableCell,{children:e.category}),(0,t.jsx)(o.TableCell,{children:e.quantity}),(0,t.jsxs)(o.TableCell,{children:[e.purchasePrice," тг"]}),(0,t.jsxs)(o.TableCell,{children:[(e.quantity*e.purchasePrice).toLocaleString()," ","тг"]}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>{H(e=>({...e,items:e.items.filter((e,t)=>t!==r)}))},children:(0,t.jsx)(m.Trash2,{className:"h-4 w-4 text-red-500"})})})]},r))})]}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 border-t",children:(0,t.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,t.jsxs)("span",{children:["Итого:"," ",I.items.reduce((e,t)=>e+t.quantity,0)," ","единиц"]}),(0,t.jsxs)("span",{children:["Сумма:"," ",I.items.reduce((e,t)=>e+t.quantity*t.purchasePrice,0).toLocaleString()," ","тг"]})]})})]}),(0,t.jsxs)(d.DialogFooter,{children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>P(!1),children:"Отмена"}),(0,t.jsx)(l.Button,{onClick:z,className:"bg-[#568a56] hover:bg-[#467046]",children:"Создать партию"})]})]})]})]})]})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:["list"===L&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[(0,t.jsx)(c.Card,{children:(0,t.jsxs)(c.CardContent,{className:"p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:C.length}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Всего партий"})]})}),(0,t.jsx)(c.Card,{children:(0,t.jsxs)(c.CardContent,{className:"p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:C.reduce((e,t)=>e+t.total_items,0).toLocaleString()}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Единиц товара"})]})}),(0,t.jsx)(c.Card,{children:(0,t.jsxs)(c.CardContent,{className:"p-4",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[C.reduce((e,t)=>e+Number(t.total_cost),0).toLocaleString()," ","тг"]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Общая сумма"})]})}),(0,t.jsx)(c.Card,{children:(0,t.jsxs)(c.CardContent,{className:"p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:C.filter(e=>"draft"===e.status).length}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Черновиков"})]})})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Партии поставок"})}),(0,t.jsx)(c.CardContent,{children:(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{children:(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableHead,{children:"Дата"}),(0,t.jsx)(o.TableHead,{children:"Поставщик"}),(0,t.jsx)(o.TableHead,{children:"Товаров"}),(0,t.jsx)(o.TableHead,{children:"Единиц"}),(0,t.jsx)(o.TableHead,{children:"Сумма"}),(0,t.jsx)(o.TableHead,{children:"Статус"}),(0,t.jsx)(o.TableHead,{children:"Создал"}),(0,t.jsx)(o.TableHead,{children:"Действия"})]})}),(0,t.jsx)(o.TableBody,{children:C.map(e=>(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableCell,{children:new Date(e.batch_date).toLocaleDateString("ru-RU")}),(0,t.jsx)(o.TableCell,{children:e.supplier_name||"-"}),(0,t.jsx)(o.TableCell,{children:e.items_count}),(0,t.jsx)(o.TableCell,{children:e.total_items}),(0,t.jsxs)(o.TableCell,{children:[Number(e.total_cost).toLocaleString()," тг"]}),(0,t.jsx)(o.TableCell,{children:W(e.status)}),(0,t.jsx)(o.TableCell,{children:e.created_by_name}),(0,t.jsx)(o.TableCell,{children:(0,t.jsxs)("div",{className:"flex gap-1",children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>F(e.id),children:(0,t.jsx)(p.Eye,{className:"h-4 w-4"})}),(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>K(e.id),children:(0,t.jsx)(y,{className:"h-4 w-4"})}),"draft"===e.status&&(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:()=>V(e.id,"received"),className:"text-green-600",children:"✓"})]})})]},e.id))})]})})]})]}),"details"===L&&S&&(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.Button,{variant:"outline",onClick:()=>O("list"),className:"mb-4",children:[(0,t.jsx)(j.ChevronLeft,{className:"h-4 w-4 mr-2"}),"Назад к списку"]}),(0,t.jsxs)(c.Card,{className:"mb-4",children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(c.CardTitle,{children:["Партия от"," ",new Date(S.batch.batch_date).toLocaleDateString("ru-RU")]}),W(S.batch.status)]})}),(0,t.jsxs)(c.CardContent,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Поставщик"}),(0,t.jsx)("div",{className:"font-medium",children:S.batch.supplier_name||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Всего единиц"}),(0,t.jsx)("div",{className:"font-medium",children:S.batch.total_items})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Общая сумма"}),(0,t.jsxs)("div",{className:"font-medium",children:[Number(S.batch.total_cost).toLocaleString()," ","тг"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Создал"}),(0,t.jsx)("div",{className:"font-medium",children:S.batch.created_by_name})]})]}),"draft"===S.batch.status&&(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(l.Button,{onClick:()=>V(S.batch.id,"received"),className:"bg-green-600 hover:bg-green-700",children:"Подтвердить получение"})})]})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsxs)(c.CardTitle,{children:["Товары в партии (",S.items.length,")"]})}),(0,t.jsx)(c.CardContent,{children:(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{children:(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableHead,{children:"Название"}),(0,t.jsx)(o.TableHead,{children:"Категория"}),(0,t.jsx)(o.TableHead,{children:"Цвет"}),(0,t.jsx)(o.TableHead,{children:"Сорт"}),(0,t.jsx)(o.TableHead,{children:"Кол-во"}),(0,t.jsx)(o.TableHead,{children:"Закуп. цена"}),(0,t.jsx)(o.TableHead,{children:"Продаж. цена"}),(0,t.jsx)(o.TableHead,{children:"Сумма"})]})}),(0,t.jsx)(o.TableBody,{children:S.items.map(e=>(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableCell,{className:"font-medium",children:e.product_name}),(0,t.jsx)(o.TableCell,{children:e.category||"-"}),(0,t.jsx)(o.TableCell,{children:e.color||"-"}),(0,t.jsx)(o.TableCell,{children:e.variety||"-"}),(0,t.jsx)(o.TableCell,{children:e.quantity}),(0,t.jsxs)(o.TableCell,{children:[Number(e.purchase_price).toFixed(2)," тг"]}),(0,t.jsx)(o.TableCell,{children:e.selling_price?Number(e.selling_price).toFixed(2)+" тг":"-"}),(0,t.jsxs)(o.TableCell,{children:[(e.quantity*Number(e.purchase_price)).toLocaleString()," ","тг"]})]},e.id))})]})})]})]}),"analytics"===L&&(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.Button,{variant:"outline",onClick:()=>O("list"),className:"mb-4",children:[(0,t.jsx)(j.ChevronLeft,{className:"h-4 w-4 mr-2"}),"Назад к списку"]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Аналитика по категориям"})}),(0,t.jsx)(c.CardContent,{children:D&&D.length>0?(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{children:(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableHead,{children:"Категория"}),(0,t.jsx)(o.TableHead,{children:"Товаров"}),(0,t.jsx)(o.TableHead,{children:"Единиц"}),(0,t.jsx)(o.TableHead,{children:"Сумма"}),(0,t.jsx)(o.TableHead,{children:"Ср. цена"})]})}),(0,t.jsx)(o.TableBody,{children:D.map((e,r)=>(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableCell,{className:"font-medium",children:e.category||"Без категории"}),(0,t.jsx)(o.TableCell,{children:e.products_count}),(0,t.jsx)(o.TableCell,{children:Number(e.total_quantity).toLocaleString()}),(0,t.jsxs)(o.TableCell,{children:[Number(e.total_cost).toLocaleString()," тг"]}),(0,t.jsxs)(o.TableCell,{children:[Number(e.avg_purchase_price).toFixed(2)," тг"]})]},r))})]}):(0,t.jsx)("p",{className:"text-gray-500",children:"Нет данных для анализа"})})]}),(0,t.jsxs)(c.Card,{children:[(0,t.jsx)(c.CardHeader,{children:(0,t.jsx)(c.CardTitle,{children:"Изменения цен"})}),(0,t.jsx)(c.CardContent,{children:U&&U.length>0?(0,t.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:U.filter(e=>e.price_change).map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:e.product_name}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:new Date(e.batch_date).toLocaleDateString("ru-RU")})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("span",{className:"text-sm",children:[Number(e.purchase_price).toFixed(2)," тг"]}),Number(e.price_change)>0?(0,t.jsxs)(u.Badge,{className:"bg-red-100 text-red-800",children:[(0,t.jsx)(g.TrendingUp,{className:"h-3 w-3 mr-1"}),"+",e.price_change,"%"]}):(0,t.jsxs)(u.Badge,{className:"bg-green-100 text-green-800",children:[(0,t.jsx)(b.TrendingDown,{className:"h-3 w-3 mr-1"}),e.price_change,"%"]})]})]},r))}):(0,t.jsx)("p",{className:"text-gray-500",children:"Нет данных об изменениях цен"})})]})]})]})]})]})}e.s(["default",()=>N],79257)}]);